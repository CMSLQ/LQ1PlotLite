#include "TROOT.h"
#include "TStyle.h"
#include "TCanvas.h"
#include "TH2F.h"
#include "TGraph.h"
#include "TF1.h"
#include "TLegend.h"
#include "TPolyLine.h"
#include "TPad.h"
#include "TLatex.h"
#include "TMath.h"
#include "stdio.h"
using namespace std;
void myStyle();
void setTDRStyle();
void BR_Sigma_EE_vsMass()
{

Double_t mTh[101] = {200.0,210.0,220.0,230.0,240.0,250.0,260.0,270.0,280.0,290.0,300.0,310.0,320.0,330.0,340.0,350.0,360.0,370.0,380.0,390.0,400.0,410.0,420.0,430.0,440.0,450.0,460.0,470.0,480.0,490.0,500.0,510.0,520.0,530.0,540.0,550.0,560.0,570.0,580.0,590.0,600.0,610.0,620.0,630.0,640.0,650.0,660.0,670.0,680.0,690.0,700.0,710.0,720.0,730.0,740.0,750.0,760.0,770.0,780.0,790.0,800.0,810.0,820.0,830.0,840.0,850.0,860.0,870.0,880.0,890.0,900.0,910.0,920.0,930.0,940.0,950.0,960.0,970.0,980.0,990.0,1000.0,1010.0,1020.0,1030.0,1040.0,1050.0,1060.0,1070.0,1080.0,1090.0,1100.0,1110.0,1120.0,1130.0,1140.0,1150.0,1160.0,1170.0,1180.0,1190.0,1200.0};
Double_t xsTh[101] = {17.4,13.4,10.5,8.27,6.57,5.26,4.24,3.44,2.8,2.3,1.89,1.57,1.3,1.09,0.914,0.77,0.65,0.551,0.469,0.4,0.342,0.294,0.253,0.218,0.188,0.163,0.142,0.123,0.107,0.0937,0.082,0.0719,0.0631,0.0555,0.0489,0.0431,0.0381,0.0337,0.0298,0.0265,0.0235,0.0209,0.0186,0.0166,0.0148,0.0132,0.0118,0.0106,0.00946,0.00848,0.00761,0.00683,0.00614,0.00552,0.00497,0.00448,0.00404,0.00364,0.00329,0.00297,0.00269,0.00243,0.0022,0.00199,0.00181,0.00164,0.00149,0.00135,0.00123,0.00111,0.00101,0.000922,0.000839,0.000764,0.000696,0.000634,0.000578,0.000527,0.000481,0.000439,0.000401,0.000366,0.000335,0.000306,0.00028,0.000256,0.000234,0.000214,0.000196,0.00018,0.000165,0.000151,0.000138,0.000127,0.000116,0.000107,9.8e-05,8.99e-05,8.25e-05,7.58e-05,6.96e-05};
Double_t x_pdf[202] = {200.0,210.0,220.0,230.0,240.0,250.0,260.0,270.0,280.0,290.0,300.0,310.0,320.0,330.0,340.0,350.0,360.0,370.0,380.0,390.0,400.0,410.0,420.0,430.0,440.0,450.0,460.0,470.0,480.0,490.0,500.0,510.0,520.0,530.0,540.0,550.0,560.0,570.0,580.0,590.0,600.0,610.0,620.0,630.0,640.0,650.0,660.0,670.0,680.0,690.0,700.0,710.0,720.0,730.0,740.0,750.0,760.0,770.0,780.0,790.0,800.0,810.0,820.0,830.0,840.0,850.0,860.0,870.0,880.0,890.0,900.0,910.0,920.0,930.0,940.0,950.0,960.0,970.0,980.0,990.0,1000.0,1010.0,1020.0,1030.0,1040.0,1050.0,1060.0,1070.0,1080.0,1090.0,1100.0,1110.0,1120.0,1130.0,1140.0,1150.0,1160.0,1170.0,1180.0,1190.0,1200.0,1200.0,1190.0,1180.0,1170.0,1160.0,1150.0,1140.0,1130.0,1120.0,1110.0,1100.0,1090.0,1080.0,1070.0,1060.0,1050.0,1040.0,1030.0,1020.0,1010.0,1000.0,990.0,980.0,970.0,960.0,950.0,940.0,930.0,920.0,910.0,900.0,890.0,880.0,870.0,860.0,850.0,840.0,830.0,820.0,810.0,800.0,790.0,780.0,770.0,760.0,750.0,740.0,730.0,720.0,710.0,700.0,690.0,680.0,670.0,660.0,650.0,640.0,630.0,620.0,610.0,600.0,590.0,580.0,570.0,560.0,550.0,540.0,530.0,520.0,510.0,500.0,490.0,480.0,470.0,460.0,450.0,440.0,430.0,420.0,410.0,400.0,390.0,380.0,370.0,360.0,350.0,340.0,330.0,320.0,310.0,300.0,290.0,280.0,270.0,260.0,250.0,240.0,230.0,220.0,210.0,200.0};
Double_t y_pdf[202] = {20.012967661,15.464000969,12.13163844,9.563257902,7.607863671,6.096402415,4.918011799,3.999746371,3.26479673,2.682883794,2.211552484,1.841088546,1.532086191,1.285181966,1.07946903,0.91007141,0.770943003,0.655432993,0.558801392,0.477566036,0.409475922,0.35217637,0.30384378,0.262601009,0.22752164,0.197246752,0.171984829,0.149544491,0.131005208,0.114447289,0.100555053,0.088321023,0.077802721,0.068569813,0.060562487,0.053535751,0.047404348,0.042052748,0.037337911,0.033234011,0.029590156,0.02634136,0.023502948,0.021047066,0.018826475,0.016841209,0.015082743,0.013551694,0.012170295,0.010921823,0.009832814,0.008851584,0.007978396,0.007192872,0.006495418,0.005867083,0.005306254,0.004803615,0.004347382,0.003936207,0.003572383,0.00323898,0.002940176,0.002670827,0.002432154,0.002211077,0.002014619,0.001830953,0.001670114,0.001519547,0.001384178,0.001266651,0.001155623,0.001055563,0.000964732,0.000881194,0.000805882,0.00073744,0.000675288,0.000618075,0.000566148,0.000519444,0.000476397,0.000436633,0.000400814,0.000367328,0.000337164,0.000309708,0.000284487,0.00026165,0.000240705,0.000221045,0.000203176,0.000187273,0.000172068,0.000158736,0.000146099,0.000134583,0.000123896,0.000114225,0.000105274,3.3578e-05,3.6993e-05,4.0687e-05,4.4858e-05,4.9379e-05,5.4542e-05,5.9569e-05,6.6067e-05,7.2153e-05,7.9956e-05,8.8291e-05,9.6989e-05,0.000106485,0.000117248,0.00012945,0.000142912,0.00015744,0.000173599,0.000191456,0.000210758,0.000233307,0.000257,0.000283769,0.000313229,0.000346375,0.000382284,0.000422354,0.000466706,0.000516221,0.000571093,0.000630362,0.000697262,0.000778115,0.000857033,0.000953227,0.001056708,0.001171348,0.001296729,0.001443256,0.00159997,0.001782145,0.001978054,0.002206831,0.002450378,0.002738232,0.00305294,0.003404114,0.003801716,0.004246934,0.004748534,0.00531285,0.005958374,0.006677879,0.007509595,0.008421184,0.00946123,0.010623578,0.012003654,0.013497167,0.015256561,0.017203175,0.019507368,0.021998071,0.025030029,0.02836702,0.032285431,0.03674255,0.041875757,0.04777812,0.05473958,0.06263999,0.07185967,0.0825196,0.095276184,0.110218087,0.12691898,0.147232856,0.170869861,0.198962143,0.232603827,0.271907204,0.318437202,0.375147509,0.442453927,0.523496206,0.622172398,0.741373235,0.88752531,1.067913809,1.283837459,1.553256774,1.89392119,2.319546048,2.856376834,3.529718366,4.390765279,5.507144883,6.951358275,8.842548945,11.335999031,14.698592959};



 // filename for the final plot (NB: changing the name extension changes the file format)
 string fileName2 = "BR_Sigma_EE.pdf";
 string fileName3 = "BR_Sigma_EE.png";
 string fileName1 = "BR_Sigma_EE.eps";

 // axes labels for the final plot
 string title = ";M_{LQ} [GeV];#sigma#times#beta^{2} [pb]";

 // integrated luminosity
 string lint = "19.7 fb^{-1}";

 /*
Double_t mData[19] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 , 1050.0 , 1100.0 , 1150.0 , 1200.0 }; 
Double_t x_shademasses[38] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 , 1050.0 , 1100.0 , 1150.0 , 1200.0 , 1200.0 , 1150.0 , 1100.0 , 1050.0 , 1000.0 , 950.0 , 900.0 , 850.0 , 800.0 , 750.0 , 700.0 , 650.0 , 600.0 , 550.0 , 500.0 , 450.0 , 400.0 , 350.0 , 300.0 }; 
Double_t xsUp_expected[19] = {0.01615700142 , 0.00797978797 , 0.005081128542 , 0.003488222331 , 0.002728730892 , 0.0019545400467 , 0.001485589677 , 0.0011632183992 , 0.00096118025095 , 0.00071524874624 , 0.00057572766695 , 0.00047206181808 , 0.00035209767863 , 0.000311429227128 , 0.000260314366208 , 0.000251180541952 , 0.000240701029305 , 0.000232385369802 , 0.000229931261986 }; 
Double_t xsUp_observed[19] = {0.02414776833 , 0.00681650585 , 0.0053910999 , 0.003399945932 , 0.002229052658 , 0.0024274091969 , 0.0014807654325 , 0.000819367956 , 0.00066967153007 , 0.00076607752704 , 0.00084817322608 , 0.00065499845364 , 0.00052260284358 , 0.000326210067914 , 0.00020897351897 , 0.000200503079936 , 0.000193022879115 , 0.000186683641831 , 0.000184584485424 }; 
Double_t y_1sigma[38]={0.01160902449 , 0.00571446876 , 0.003626514306 , 0.002495982325 , 0.001947555842 , 0.0013867224585 , 0.001054960026 , 0.0008175063468 , 0.00067318257099 , 0.00049297222912 , 0.00039327391389 , 0.0003188412396 , 0.00022754774699 , 0.000196755551758 , 0.00015660131898 , 0.000150782684416 , 0.00014480222229 , 0.000139799641007 , 0.000138323292718 , 0.00040040320931 , 0.000404676813137 , 0.0004172388231 , 0.000433401916416 , 0.000453312461817 , 0.000512531214704 , 0.00056261916478 , 0.00071855909068 , 0.00086717680371 , 0.00105451919552 , 0.00139411777022 , 0.0016778853036 , 0.002131046787 , 0.0027725823998 , 0.003849045396 , 0.004948163616 , 0.007167248856 , 0.01125598936 , 0.02253284838 }; 
Double_t y_2sigma[38]={0.00874118952 , 0.00428601866 , 0.002709273726 , 0.00185993106 , 0.001454967902 , 0.0010345319291 , 0.000783416445 , 0.0006066002316 , 0.00049748588933 , 0.00036181529216 , 0.0002856148926 , 0.00023142091824 , 0.00015885657538 , 0.000135642028378 , 0.000103210578589 , 9.9098571776e-05 , 9.5434193085e-05 , 9.2137166177e-05 , 9.11641562376e-05 , 0.00065950509565 , 0.000666544133154 , 0.00069014088396 , 0.000714759399424 , 0.000746652100112 , 0.000814630271494 , 0.00087618650592 , 0.00106301286628 , 0.00125717111533 , 0.0015053243072 , 0.00194946258087 , 0.0023242798392 , 0.0029420547465 , 0.0038006439845 , 0.005221863894 , 0.006694499161 , 0.009658837188 , 0.01516896689 , 0.03011750154 }; 
 */
 /*
Double_t mData[15] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 }; 
Double_t x_shademasses[30] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 , 1000.0 , 950.0 , 900.0 , 850.0 , 800.0 , 750.0 , 700.0 , 650.0 , 600.0 , 550.0 , 500.0 , 450.0 , 400.0 , 350.0 , 300.0 }; 
Double_t xsUp_expected[15] = {0.017388 , 0.008316 , 0.0056088 , 0.0038142 , 0.0028782 , 0.00205587 , 0.00157685 , 0.00122364 , 0.001015174 , 0.000779968 , 0.000628653 , 0.0004838 , 0.000364509 , 0.0003135764 , 0.0002596074 }; 
Double_t xsUp_observed[15] = {0.025326 , 0.007238 , 0.0058824 , 0.0037164 , 0.0023944 , 0.00251704 , 0.00156745 , 0.00090024 , 0.000746541 , 0.000825664 , 0.00087425 , 0.000663052 , 0.000526311 , 0.0003269538 , 0.0002086403 }; 
Double_t y_1sigma[30]={0.012663 , 0.006006 , 0.0040356 , 0.0027547 , 0.0020746 , 0.00148264 , 0.0011374 , 0.00088308 , 0.000732843 , 0.000562688 , 0.000453803 , 0.000349156 , 0.000263004 , 0.0002262746 , 0.0001873472 , 0.0003605792 , 0.000435558 , 0.000506313 , 0.000671908 , 0.000873174 , 0.001083264 , 0.001410133 , 0.00170016 , 0.0021902 , 0.00285322 , 0.0039934 , 0.0052975 , 0.0077634 , 0.011627 , 0.024192 }; 
Double_t y_2sigma[30]={0.00945 , 0.004543 , 0.0030438 , 0.0020701 , 0.001558 , 0.00111629 , 0.0008554 , 0.00066396 , 0.000550964 , 0.00042336 , 0.000341092 , 0.0002624 , 0.000197758 , 0.0001701022 , 0.0001408312 , 0.0004790747 , 0.0005786518 , 0.00067266 , 0.000892652 , 0.001160197 , 0.001439424 , 0.001872821 , 0.00225852 , 0.0029093 , 0.0037928 , 0.0053054 , 0.0070416 , 0.0103284 , 0.0154 , 0.03213 }; 
 */

 Double_t mData[19] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 , 1050.0 , 1100.0 , 1150.0 , 1200.0 };
 Double_t x_shademasses[38] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 , 1050.0 ,1100.0 , 1150.0 , 1200.0 , 1200.0 , 1150.0 , 1100.0 , 1050.0 , 1000.0 , 950.0 , 900.0 , 850.0 , 800.0 , 750.0 , 700.0 , 650.0 , 600.0 , 550.0 , 500.0 , 450.0 , 400.0 , 350.0 , 300.0 }; 
 Double_t xsUp_expected[19] = {0.015876 , 0.010164 , 0.006327 , 0.0047922 , 0.003198 , 0.00223689 , 0.00176015 , 0.00139788 , 0.001076815 , 0.000796992 , 0.00064291 , 0.000554976 , 0.000461974 , 0.0003599852 , 0.0003226045 , 0.000308352 , 0.000302346 , 0.0002945496 , 0.00028848504 }; 
 Double_t xsUp_observed[19] = {0.014742 , 0.011319 , 0.0069768 , 0.0066504 , 0.005863 , 0.00357299 , 0.00353675 , 0.00302412 , 0.001467969 , 0.001367744 , 0.000944459 , 0.000777032 , 0.000596405 , 0.0003709534 , 0.0003835565 , 0.0003666944 , 0.000359568 , 0.0003502859 , 0.00034245288 }; 
 Double_t y_1sigma[38]={0.011529 , 0.007315 , 0.0045828 , 0.0034556 , 0.0023124 , 0.00161625 , 0.001269 , 0.0010098 , 0.000776981 , 0.000575232 , 0.000464025 , 0.000400488 , 0.000333401 , 0.0002598132 , 0.0002328206 , 0.0002225152 , 0.000218196 , 0.0002125662 , 0.00020819448 , 0.00040070808 , 0.0004091252 , 0.000419958 , 0.000428288 , 0.0004480774 , 0.0004999724 , 0.000641653 , 0.000770964 , 0.00089308 , 0.001107008 , 0.001496126 , 0.00194304 , 0.002444 , 0.00310751 , 0.0044444 , 0.0066667 , 0.0088236 , 0.014091 , 0.022113 }; 
 Double_t y_2sigma[38]={0.008694 , 0.005544 , 0.0034542 , 0.002608 , 0.0017384 , 0.00121542 , 0.0009541 , 0.000759 , 0.000584448 , 0.00043232 , 0.000348893 , 0.000301104 , 0.000250682 , 0.000195272 , 0.0001750365 , 0.000167296 , 0.000164043 , 0.0001598045 , 0.00015651648 , 0.00053239128 , 0.0005435707 , 0.000557964 , 0.0005690368 , 0.0005953647 , 0.0006643052 , 0.000852541 , 0.001024344 , 0.001186559 , 0.001470784 , 0.001987732 , 0.0025806 , 0.0032477 , 0.00412898 , 0.0059122 , 0.0088509 , 0.0116964 , 0.018711 , 0.029484 }; 

/*

//BETA ONE ASYMPTOTIC CLS RESULTS
//


Double_t mData[19] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 , 1050.0 , 1100.0 , 1150.0 , 1200.0 }; 
Double_t x_shademasses[38] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 , 1050.0 , 1100.0 , 1150.0 , 1200.0 , 1200.0 , 1150.0 , 1100.0 , 1050.0 , 1000.0 , 950.0 , 900.0 , 850.0 , 800.0 , 750.0 , 700.0 , 650.0 , 600.0 , 550.0 , 500.0 , 450.0 , 400.0 , 350.0 , 300.0 }; 
Double_t xsUp_expected[19] = {0.016254 , 0.008085 , 0.0051642 , 0.0035697 , 0.0027552 , 0.00196967 , 0.0015604 , 0.00119328 , 0.001001476 , 0.000751296 , 0.00066981 , 0.000544152 , 0.000405212 , 0.0003334206 , 0.0002825847 , 0.000270848 , 0.0002608815 , 0.0002525521 , 0.000249864 }; 
Double_t xsUp_observed[19] = {0.020601 , 0.00693 , 0.0058824 , 0.0039283 , 0.0032144 , 0.00249118 , 0.00151575 , 0.00094512 , 0.000778503 , 0.000886144 , 0.00088232 , 0.000639928 , 0.000571054 , 0.000355674 , 0.0002267655 , 0.0002176768 , 0.0002093355 , 0.0002029041 , 0.00020031576 }; 
Double_t y_1sigma[38]={0.011718 , 0.005852 , 0.0037278 , 0.0025754 , 0.0019844 , 0.0014223 , 0.00112565 , 0.00086064 , 0.00072295 , 0.00054208 , 0.000483393 , 0.00039278 , 0.000292395 , 0.000240603 , 0.0002039486 , 0.000195456 , 0.0001882815 , 0.0001822638 , 0.00018031968 , 0.00034706736 , 0.0003507995 , 0.000362373 , 0.000376192 , 0.0003924988 , 0.000463137 , 0.000562873 , 0.000755876 , 0.000930471 , 0.001043392 , 0.001391869 , 0.0016566 , 0.0021667 , 0.00273685 , 0.0038212 , 0.0049552 , 0.007182 , 0.011165 , 0.02268 }; 
Double_t y_2sigma[38]={0.008883 , 0.004389 , 0.0028044 , 0.0019397 , 0.0014924 , 0.00106888 , 0.000846 , 0.0006468 , 0.000543354 , 0.00040768 , 0.000363419 , 0.0002952 , 0.000219877 , 0.0001808802 , 0.0001533023 , 0.000146944 , 0.000141537 , 0.0001370242 , 0.00013556688 , 0.00046112088 , 0.0004660813 , 0.0004814535 , 0.00049984 , 0.0005215005 , 0.0006153604 , 0.000747804 , 0.001004336 , 0.001236324 , 0.00138656 , 0.001848469 , 0.00220176 , 0.00287875 , 0.00363333 , 0.0050758 , 0.0065852 , 0.0095418 , 0.014861 , 0.030051 }; 


//
// BETA HALF ASYMPTOTIC CLS RESULTS
//


Double_t mData[19] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 , 1050.0 , 1100.0 , 1150.0 , 1200.0 }; 
Double_t x_shademasses[38] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 , 1050.0 , 1100.0 , 1150.0 , 1200.0 , 1200.0 , 1150.0 , 1100.0 , 1050.0 , 1000.0 , 950.0 , 900.0 , 850.0 , 800.0 , 750.0 , 700.0 , 650.0 , 600.0 , 550.0 , 500.0 , 450.0 , 400.0 , 350.0 , 300.0 }; 
Double_t xsUp_expected[19] = {0.137214 , 0.047047 , 0.0233415 , 0.01149965 , 0.007134 , 0.00474962 , 0.0032007 , 0.00241362 , 0.0019493015 , 0.001670368 , 0.0014257 , 0.000987116 , 0.0008679435 , 0.0007390855 , 0.0007075645 , 0.0006414848 , 0.000597399 , 0.0005672177 , 0.00052950636 }; 
Double_t xsUp_observed[19] = {0.1575315 , 0.056364 , 0.0320796 , 0.01541165 , 0.0094997 , 0.00594349 , 0.0047141 , 0.00337788 , 0.0028685895 , 0.002370816 , 0.002009699 , 0.00138211 , 0.001094436 , 0.0011151109 , 0.00115465945 , 0.0010432512 , 0.00097443225 , 0.0009235491 , 0.00086238924 }; 
Double_t y_1sigma[38]={0.099036 , 0.033957 , 0.0168435 , 0.0082967 , 0.0051496 , 0.003428605 , 0.00231005 , 0.00174174 , 0.0014067085 , 0.001205344 , 0.001028925 , 0.000712334 , 0.0006263515 , 0.0005333842 , 0.0005106334 , 0.0004629376 , 0.0004311285 , 0.00040934455 , 0.00038213184 , 0.00073548756 , 0.0007878624 , 0.00082979325 , 0.0008910208 , 0.0009828109 , 0.0010265728 , 0.001205536 , 0.00137104 , 0.001980378 , 0.002319968 , 0.0027072575 , 0.0033528 , 0.0044462 , 0.006596455 , 0.0099097 , 0.015974 , 0.0324216 , 0.0653345 , 0.1906065 }; 
Double_t y_2sigma[38]={0.074466 , 0.0255255 , 0.0126711 , 0.00623475 , 0.0038704 , 0.00257738 , 0.00173665 , 0.00130944 , 0.0010574095 , 0.000906304 , 0.0007735095 , 0.000535542 , 0.0004709125 , 0.0004009733 , 0.00038389735 , 0.000348032 , 0.00032411775 , 0.0003077427 , 0.00028728444 , 0.00097719096 , 0.001046781 , 0.00110248875 , 0.0011838464 , 0.00130579635 , 0.0013639242 , 0.001601759 , 0.00182163 , 0.0026312235 , 0.003082464 , 0.003597247 , 0.00445434 , 0.005906725 , 0.008764385 , 0.0131692 , 0.0212226 , 0.0430749 , 0.0868175 , 0.25326 }; 

*/


  // turn on/off batch mode
 gROOT->SetBatch(kTRUE);


 // set ROOT style
//  myStyle();
 setTDRStyle();
 gStyle->SetPadLeftMargin(0.14);
 gROOT->ForceStyle();
 
 TCanvas *c = new TCanvas("c","",800,800);
 c->cd();
 
 TH2F *bg = new TH2F("bg",title.c_str(), 500, 300., 1200., 500., 0.00001, 50.);
 bg->GetXaxis()->CenterTitle();
 bg->GetYaxis()->CenterTitle();
 bg->SetStats(kFALSE);
 bg->SetTitleOffset(1.,"X");
 bg->SetTitleOffset(1.1,"Y");
 
 bg->Draw();



 TGraph *xsTh_vs_m = new TGraph(101, mTh, xsTh);
 xsTh_vs_m->SetLineWidth(2);
 xsTh_vs_m->SetLineColor(kBlue);
 xsTh_vs_m->SetFillColor(kCyan-6);
 xsTh_vs_m->SetMarkerSize(0.00001);
 xsTh_vs_m->SetMarkerStyle(22);
 xsTh_vs_m->SetMarkerColor(kBlue);

 TGraph *xsData_vs_m_expected = new TGraph(19, mData, xsUp_expected);
 xsData_vs_m_expected->SetMarkerStyle(0);
 xsData_vs_m_expected->SetMarkerColor(kBlack);
 xsData_vs_m_expected->SetLineColor(kBlack);
 xsData_vs_m_expected->SetLineWidth(2);
 xsData_vs_m_expected->SetLineStyle(7);
 xsData_vs_m_expected->SetMarkerSize(0.001);

 TGraph *xsData_vs_m_observed = new TGraph(19, mData, xsUp_observed);
 xsData_vs_m_observed->SetMarkerStyle(21);
 xsData_vs_m_observed->SetMarkerColor(kBlack);
 xsData_vs_m_observed->SetLineColor(kBlack);
 xsData_vs_m_observed->SetLineWidth(2);
 xsData_vs_m_observed->SetLineStyle(1);
 xsData_vs_m_observed->SetMarkerSize(1);
 
 Double_t xsUp_observed_logY[19], xsUp_expected_logY[19], xsTh_logY[101];
 for (int ii = 0; ii<19; ++ii) xsUp_observed_logY[ii] = log10(xsUp_observed[ii]);
 for (int ii = 0; ii<19; ++ii) xsUp_expected_logY[ii] = log10(xsUp_expected[ii]);
 for (int ii = 0; ii<101; ++ii) xsTh_logY[ii] = log10(xsTh[ii]);
 TGraph *xsTh_vs_m_log = new TGraph(101, mTh, xsTh_logY);
 TGraph *xsData_vs_m_expected_log = new TGraph(19, mData, xsUp_expected_logY);
 TGraph *xsData_vs_m_observed_log = new TGraph(19, mData, xsUp_observed_logY);
 

 double obslim = 0.0;
 double exlim = 0.0;
 for (Double_t mtest=300.10; mtest<1199.90; mtest = mtest+0.10){
   if(( pow(10.0,xsData_vs_m_expected_log->Eval(mtest))/pow(10.0,xsTh_vs_m_log->Eval(mtest)) ) < 1.0 && ( pow(10.0,xsData_vs_m_expected_log->Eval(mtest+0.1))/pow(10.0,xsTh_vs_m_log->Eval(mtest+0.10)) ) > 1.0) exlim = mtest; 
   if(( pow(10.0,xsData_vs_m_observed_log->Eval(mtest))/pow(10.0,xsTh_vs_m_log->Eval(mtest)) ) < 1.0 && ( pow(10.0,xsData_vs_m_observed_log->Eval(mtest+0.1))/pow(10.0,xsTh_vs_m_log->Eval(mtest+0.10)) ) > 1.0) obslim = mtest; 
  }
  std::cout<<"## LLJJ expected limit: "<<exlim<<" GeV"<<std::endl;
  std::cout<<"## LLJJ observed limit: "<<obslim<<" GeV"<<std::endl;

 // region excluded by Tevatron limits
 Double_t x_shaded[5] = {675,840,840,675,675};// CHANGED FOR LQ2
 Double_t y_shaded[5] = {0.00001,0.00001,50,50,0.00001};// CHANGED FOR LQ2

 Double_t x_shaded2[5] = {300,675,675,300,300};// CHANGED FOR LQ2
 Double_t y_shaded2[5] = {0.00001,0.00001,50,50,0.00001};// CHANGED FOR LQ2

 Double_t x_shaded3[5] = {840,obslim,obslim,840,840};// CHANGED FOR LQ2
 Double_t y_shaded3[5] = {0.00001,0.00001,50,50,0.00001};// CHANGED FOR LQ2


 TPolyLine *p2 = new TPolyLine(5,x_shaded2,y_shaded2,"");
//  pl->SetFillStyle(3001);
 p2->SetFillColor(8);
 p2->SetFillStyle(3345);
 p2->SetLineColor(8);   // CHANGED FOR LQ2
 p2->Draw();
 p2->Draw("F");


 TPolyLine *pl = new TPolyLine(5,x_shaded,y_shaded,"");
//  pl->SetFillStyle(3001);
 pl->SetLineColor(14);
 pl->SetFillColor(14);
 pl->SetFillStyle(3344);
 pl->Draw();
 pl->Draw("F");
 
 

 TPolyLine *p3 = new TPolyLine(5,x_shaded3,y_shaded3,"");
 p3->SetLineColor(46);
 p3->SetFillColor(46);
 p3->SetFillStyle(3354);
 p3->Draw();
 p3->Draw("F");



 TGraph *exshade1 = new TGraph(38,x_shademasses,y_1sigma);
 exshade1->SetFillColor(kGreen);
 TGraph *exshade2 = new TGraph(38,x_shademasses,y_2sigma);
 exshade2->SetFillColor(kYellow);

 exshade2->Draw("f");
 exshade1->Draw("f");

 gPad->RedrawAxis();


 TGraph *grshade = new TGraph(202,x_pdf,y_pdf);
 grshade->SetFillColor(kCyan-6);
 grshade->SetFillStyle(3001);
 grshade->Draw("f");



 // set ROOT style
//  myStyle();
 setTDRStyle();
 gStyle->SetPadLeftMargin(0.14);
 gROOT->ForceStyle();


 
 xsTh_vs_m->Draw("L");
 xsData_vs_m_expected->Draw("LP");
 xsData_vs_m_observed->Draw("LP");


 
 grshade->SetFillStyle(1001); 


 TLegend *legend = new TLegend(.37,.58,.92,.87);
 legend->SetBorderSize(1);
 legend->SetFillColor(0);
 //legend->SetFillStyle(0);
 legend->SetTextFont(42);
 legend->SetMargin(0.15);
 legend->SetHeader("LQ #bar{LQ} #rightarrow eejj");
 legend->AddEntry(p2,"ATLAS exclusion (1.03 fb^{-1}, 7 TeV)","f");
 legend->AddEntry(pl,"CMS exclusion (5.0 fb^{-1}, 7 TeV)","f");
 legend->AddEntry(p3,"CMS exclusion (19.7 fb^{-1}, 8 TeV)","f");

 legend->AddEntry(xsTh_vs_m,"#sigma_{theory}#times#beta^{2}  with unc., (#beta=1)","lf");
 legend->AddEntry(xsData_vs_m_expected, "Expected 95% CL upper limit","lp");
 legend->AddEntry(xsData_vs_m_observed, "Observed 95% CL upper limit","lp");
 legend->Draw();

 TLatex l1;
 l1.SetTextAlign(12);
 l1.SetTextFont(42);
 l1.SetNDC();
 l1.SetTextSize(0.04);
// double stamp_x = 0.76;
//  double stamp_y = 0.58;

 // l1.DrawLatex(stamp_x,stamp_y - 0.00,"CMS 2012");	   
 // l1.DrawLatex(stamp_x,stamp_y - 0.05,"#sqrt{s} = 8 TeV");
  //l1.DrawLatex(0.70,0.53,"CMS 2011");
 //l1.DrawLatex(0.70,0.48,"#sqrt{s} = 7 TeV");

 //l1.DrawLatex(0.14,0.93,"CMS #it{Preliminary}          #sqrt{s} = 8 TeV         19.7 fb^{-1}");
 //l1.DrawLatex(0.14,0.93,  "  CMS                        #sqrt{s} = 8 TeV         19.7 fb^{-1}");
 l1.DrawLatex(0.14,0.93,"CMS                   #sqrt{s} = 8 TeV                  19.7 fb^{-1}");
 // l1.DrawLatex(0.14,0.93,"CMS Work In Progres       #sqrt{s} = 8 TeV         19.6 fb^{-1}");
 // l1.DrawLatex(0.76,0.53,"Preliminary");
 // l1.DrawLatex(0.76,0.48,"#sqrt{s} = 8 TeV");
 // l1.DrawLatex(0.76,0.43,"19.6 fb^{-1}");

//  TLatex l2;
//  l2.SetTextAlign(12);
//  l2.SetTextSize(0.037);
//  l2.SetTextFont(42);
//  l2.SetNDC();
//  l2.DrawLatex(0.4,0.485,"EXO-10-005 scaled to #sqrt{s} = 7 TeV");

 c->SetGridx();
 c->SetGridy();
 c->RedrawAxis();
 legend->Draw();


 c->SetLogy();
 c->SaveAs((fileName1).c_str());
 c->SaveAs((fileName2).c_str());
 c->SaveAs((fileName3).c_str());

 delete pl;
 delete xsTh_vs_m;
 delete bg;
 delete c;
}


void myStyle()
{
 gStyle->Reset("Default");
 gStyle->SetCanvasColor(0);
 gStyle->SetPadColor(0);
 gStyle->SetTitleFillColor(10);
 gStyle->SetCanvasBorderMode(0);
 gStyle->SetStatColor(0);
 gStyle->SetPadBorderMode(0);
 gStyle->SetPadTickX(1);  // To get tick marks on the opposite side of the frame
 gStyle->SetPadTickY(1);
 gStyle->SetFrameBorderMode(0);
 gStyle->SetPalette(1);

   //gStyle->SetOptStat(kFALSE);
 gStyle->SetOptStat(111110);
 gStyle->SetOptFit(0);
 gStyle->SetStatFont(42);
 gStyle->SetPadLeftMargin(0.13);
 gStyle->SetPadRightMargin(0.07);
 gStyle->SetStatY(.9);
}

void setTDRStyle() {
  TStyle *tdrStyle = new TStyle("tdrStyle","Style for P-TDR");

  // For the canvas:
  tdrStyle->SetCanvasBorderMode(0);
  tdrStyle->SetCanvasColor(kWhite);
  tdrStyle->SetCanvasDefH(600); //Height of canvas
  tdrStyle->SetCanvasDefW(600); //Width of canvas
  tdrStyle->SetCanvasDefX(0);   //POsition on screen
  tdrStyle->SetCanvasDefY(0);

  // For the Pad:
  tdrStyle->SetPadBorderMode(0);
  // tdrStyle->SetPadBorderSize(Width_t size = 1);
  tdrStyle->SetPadColor(kWhite);
  tdrStyle->SetPadGridX(false);
  tdrStyle->SetPadGridY(false);
  tdrStyle->SetGridColor(0);
  tdrStyle->SetGridStyle(3);
  tdrStyle->SetGridWidth(1);

  // For the frame:
  tdrStyle->SetFrameBorderMode(0);
  tdrStyle->SetFrameBorderSize(1);
  tdrStyle->SetFrameFillColor(0);
  tdrStyle->SetFrameFillStyle(0);
  tdrStyle->SetFrameLineColor(1);
  tdrStyle->SetFrameLineStyle(1);
  tdrStyle->SetFrameLineWidth(1);

  // For the histo:
  tdrStyle->SetHistFillColor(63);
  // tdrStyle->SetHistFillStyle(0);
  tdrStyle->SetHistLineColor(1);
  tdrStyle->SetHistLineStyle(0);
  tdrStyle->SetHistLineWidth(1);


  tdrStyle->SetMarkerStyle(20);

  //For the fit/function:
  tdrStyle->SetOptFit(1);
  tdrStyle->SetFitFormat("5.4g");
  tdrStyle->SetFuncColor(2);
  tdrStyle->SetFuncStyle(1);
  tdrStyle->SetFuncWidth(1);

  //For the date:
  tdrStyle->SetOptDate(0);

  // For the statistics box:
  tdrStyle->SetOptFile(0);
  tdrStyle->SetOptStat(0); // To display the mean and RMS:   SetOptStat("mr");
  tdrStyle->SetStatColor(kWhite);
  tdrStyle->SetStatFont(42);
  tdrStyle->SetStatFontSize(0.025);
  tdrStyle->SetStatTextColor(1);
  tdrStyle->SetStatFormat("6.4g");
  tdrStyle->SetStatBorderSize(1);
  tdrStyle->SetStatH(0.1);
  tdrStyle->SetStatW(0.15);


  // Margins:
  tdrStyle->SetPadTopMargin(0.1);
  tdrStyle->SetPadBottomMargin(0.13);
  tdrStyle->SetPadLeftMargin(0.13);
  tdrStyle->SetPadRightMargin(0.05);

  // For the Global title:

  //  tdrStyle->SetOptTitle(0);
  tdrStyle->SetTitleFont(42);
  tdrStyle->SetTitleColor(1);
  tdrStyle->SetTitleTextColor(1);
  tdrStyle->SetTitleFillColor(10);
  tdrStyle->SetTitleFontSize(0.05);

  // For the axis titles:

  tdrStyle->SetTitleColor(1, "XYZ");
  tdrStyle->SetTitleFont(42, "XYZ");
  tdrStyle->SetTitleSize(0.06, "XYZ");
  tdrStyle->SetTitleXOffset(0.9);
  tdrStyle->SetTitleYOffset(1.05);

  // For the axis labels:

  tdrStyle->SetLabelColor(1, "XYZ");
  tdrStyle->SetLabelFont(42, "XYZ");
  tdrStyle->SetLabelOffset(0.007, "XYZ");
  tdrStyle->SetLabelSize(0.04, "XYZ");

  // For the axis:

  tdrStyle->SetAxisColor(1, "XYZ");
  tdrStyle->SetStripDecimals(kTRUE);
  tdrStyle->SetTickLength(0.03, "XYZ");
  tdrStyle->SetNdivisions(510, "XYZ");
  tdrStyle->SetPadTickX(1);  // To get tick marks on the opposite side of the frame
  tdrStyle->SetPadTickY(1);

  // Change for log plots:
  tdrStyle->SetOptLogx(0);
  tdrStyle->SetOptLogy(0);
  tdrStyle->SetOptLogz(0);
  
  tdrStyle->cd();
}
